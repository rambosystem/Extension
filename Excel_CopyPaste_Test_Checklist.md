# Excel 组件复制粘贴功能测试清单

## ✅ 自动化测试（已通过）

- [x] 项目构建成功（无 TypeScript 错误）
- [x] 无 Linter 错误
- [x] 所有模块正确导入

## 📋 手动测试清单

### 1. 复制功能测试

#### 1.1 单单元格复制

- [ ] **Ctrl+C 复制单个单元格**

  - 步骤：选中单元格 A1，按 Ctrl+C
  - 预期：能够在其他应用（如记事本）中粘贴

- [ ] **右键菜单复制单个单元格**
  - 步骤：选中单元格 A1，点击右键菜单的 "Copy"
  - 预期：能够在其他应用中粘贴

#### 1.2 矩形选区复制

- [ ] **Ctrl+C 复制矩形选区（2x2）**

  - 步骤：选中 A1:B2，按 Ctrl+C
  - 预期：复制的数据格式为制表符分隔（可在 Excel 中正确粘贴）

- [ ] **Ctrl+C 复制矩形选区（5x3）**

  - 步骤：选中 A1:C5，按 Ctrl+C
  - 预期：能够正确复制所有单元格

- [ ] **右键菜单复制矩形选区**
  - 步骤：选中任意矩形区域，点击右键菜单的 "Copy"
  - 预期：能够正确复制

#### 1.3 多选区域复制（新功能）

- [ ] **Ctrl+C 复制多选区域**
  - 步骤：按住 Ctrl，选中多个不相邻的单元格/区域，按 Ctrl+C
  - 预期：复制一个大矩形，未选中的单元格为空

#### 1.4 编辑状态复制

- [ ] **编辑状态下的文本复制（浏览器原生）**
  - 步骤：双击单元格进入编辑模式，选中部分文本，按 Ctrl+C
  - 预期：仅复制选中的文本，不是整个单元格

---

### 2. 粘贴功能测试

#### 2.1 单单元格粘贴

- [ ] **Ctrl+V 粘贴到单个单元格**

  - 步骤：复制一个单元格，选中另一个单元格，按 Ctrl+V
  - 预期：正确粘贴，保存历史记录

- [ ] **右键菜单粘贴到单个单元格**
  - 步骤：复制一个单元格，选中另一个单元格，点击右键菜单的 "Paste"
  - 预期：正确粘贴

#### 2.2 矩形数据粘贴

- [ ] **Ctrl+V 粘贴矩形数据（2x2）**

  - 步骤：复制 2x2 区域，选中目标单元格，按 Ctrl+V
  - 预期：正确粘贴，选区自动更新为粘贴区域

- [ ] **Ctrl+V 粘贴矩形数据（5x3）**
  - 步骤：复制 5x3 区域，选中目标单元格，按 Ctrl+V
  - 预期：正确粘贴

#### 2.3 自动扩展行列

- [ ] **粘贴超出表格范围（扩展行）**

  - 步骤：在最后一行粘贴多行数据
  - 预期：自动添加新行，粘贴成功

- [ ] **粘贴超出表格范围（扩展列）**

  - 步骤：在最后一列粘贴多列数据
  - 预期：自动添加新列（A-Z, AA-AZ...），粘贴成功

- [ ] **粘贴超出表格范围（同时扩展行列）**
  - 步骤：在右下角粘贴大量数据
  - 预期：同时扩展行和列，粘贴成功

#### 2.4 跨应用粘贴

- [ ] **从 Excel 粘贴**

  - 步骤：在 Excel 中复制数据，在组件中按 Ctrl+V
  - 预期：正确解析制表符和换行符，粘贴成功

- [ ] **从 Google Sheets 粘贴**

  - 步骤：在 Google Sheets 中复制数据，在组件中按 Ctrl+V
  - 预期：正确解析，粘贴成功

- [ ] **从记事本粘贴**
  - 步骤：在记事本中复制制表符分隔的数据，在组件中按 Ctrl+V
  - 预期：正确解析，粘贴成功

#### 2.5 编辑状态粘贴

- [ ] **编辑状态下的文本粘贴（浏览器原生）**
  - 步骤：双击单元格进入编辑模式，按 Ctrl+V
  - 预期：粘贴到输入框中，不触发表格粘贴

---

### 3. 撤销/重做测试

- [ ] **复制粘贴后撤销（Ctrl+Z）**

  - 步骤：粘贴数据后，按 Ctrl+Z
  - 预期：恢复到粘贴前的状态

- [ ] **撤销后重做（Ctrl+Shift+Z 或 Ctrl+Y）**

  - 步骤：撤销后，按 Ctrl+Shift+Z（Mac）或 Ctrl+Y（Windows）
  - 预期：重新执行粘贴操作

- [ ] **连续复制粘贴的撤销/重做**
  - 步骤：执行多次复制粘贴，然后多次撤销和重做
  - 预期：每一步都能正确恢复

---

### 4. 边界情况测试

#### 4.1 空数据处理

- [ ] **复制空单元格**

  - 步骤：选中空单元格，按 Ctrl+C，然后粘贴
  - 预期：粘贴空字符串

- [ ] **粘贴空字符串**
  - 步骤：复制空白区域，粘贴到组件
  - 预期：清空目标单元格

#### 4.2 特殊字符处理

- [ ] **复制粘贴包含制表符的数据**

  - 步骤：在单元格中输入包含制表符的文本，复制粘贴
  - 预期：正确处理

- [ ] **复制粘贴包含换行符的数据**

  - 步骤：在单元格中输入包含换行符的文本，复制粘贴
  - 预期：正确处理

- [ ] **复制粘贴包含特殊字符的数据（&, <, >）**
  - 步骤：输入特殊字符，复制粘贴
  - 预期：不丢失，不转义错误

#### 4.3 大数据量测试

- [ ] **复制粘贴 100x100 单元格**

  - 步骤：选中大区域，复制粘贴
  - 预期：不卡顿，能够完成

- [ ] **复制粘贴 1000x10 单元格**
  - 步骤：选中长列表，复制粘贴
  - 预期：能够完成，性能可接受

---

### 5. 跨平台测试

#### 5.1 快捷键测试

- [ ] **Windows 平台（Ctrl+C / Ctrl+V）**

  - 预期：快捷键正常工作

- [ ] **macOS 平台（Cmd+C / Cmd+V）**

  - 预期：快捷键正常工作

- [ ] **Linux 平台（Ctrl+C / Ctrl+V）**
  - 预期：快捷键正常工作

#### 5.2 浏览器兼容性测试

- [ ] **Chrome/Edge 浏览器**

  - 预期：Clipboard API 正常工作

- [ ] **Firefox 浏览器**

  - 预期：Clipboard API 正常工作

- [ ] **Safari 浏览器**
  - 预期：Clipboard API 正常工作（可能需要权限）

---

### 6. 错误处理测试

- [ ] **剪贴板权限被拒绝**

  - 步骤：在浏览器中拒绝剪贴板权限，尝试复制粘贴
  - 预期：降级到 execCommand，或显示友好错误提示

- [ ] **粘贴无效数据格式**
  - 步骤：复制图片或其他非文本数据，尝试粘贴
  - 预期：不崩溃，显示错误提示或静默忽略

---

### 7. 集成测试

- [ ] **复制粘贴后数据同步**

  - 步骤：粘贴数据后，检查父组件能否立即获取最新数据
  - 预期：v-model 正确更新

- [ ] **复制粘贴后 change 事件触发**
  - 步骤：粘贴数据后，监听 change 事件
  - 预期：change 事件正确触发

---

## 🐛 已知问题

### 无

---

## 📊 测试结果

**测试日期：** _待填写_

**测试人员：** _待填写_

**通过率：** _待计算_

**发现的 Bug 数量：** _待填写_

---

## 📝 备注

- 所有自动化测试已通过（构建成功，无类型错误）
- 手动测试需要在实际浏览器环境中进行
- 建议优先测试最常用的场景（单单元格复制、矩形选区粘贴）
- 跨平台测试可以在 CI/CD 环境中自动化
